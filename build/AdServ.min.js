/*! AdServ  0.1.1 2013-06-10 13:02:49 */
"use strict";!function(a,b){a.AdServ=b(a,a.document)}(window,function(a,b){var c=a.AdServ||{};c.version="0.1.1",c.released="2013-06-10 13:02:49",a.AdServ=c;var d=a.console;d||(c.history=[],d={},d.log=function(){var a=z.call(arguments);1==I(a)&&(a=a[0]),c.history.push(a)},d.error=function(){d.log.apply(null,arguments)}),a.adServingLoad=a.adServingLoad||"";var e=c.ready=function(a){function c(a){for(m=1;a=e.shift();)a()}var d,e=[],f=!1,g=b.documentElement,h=g.doScroll,i="DOMContentLoaded",j="addEventListener",k="onreadystatechange",l="readyState",m=/^loade|c/.test(b[l]);return b[j]&&b[j](i,d=function(){b.removeEventListener(i,d,f),c()},f),h&&b.attachEvent(k,d=function(){/^c/.test(b[l])&&(b.detachEvent(k,d),c())}),a=h?function(b){self!=top?m?b():e.push(b):function(){try{g.doScroll("left")}catch(c){return setTimeout(function(){a(b)},50)}b()}()}:function(a){m?a():e.push(a)}}(),f=c.get=function(a,b){var c,d;try{d=new XMLHttpRequest}catch(e){try{d=new ActiveXObject("Msxml2.XMLHTTP")}catch(e){return null}}var f=function(){d.abort(),b("aborted by a timeout",null,d)};return c=setTimeout(f,5e3),d.onreadystatechange=function(){4==d.readyState&&(clearTimeout(c),b(200!=d.status?"err : "+d.status:null,d.responseText,d))},d.open("GET",a,!0),d.send(),d},g=c.getJSON=function(a,b){return f(a,function(a,c,d){var e=c;a||(e=x(c)),b(a,e,d)})},h=c.$=function(a,c){return G(a)?a:(c||(c=b),c.querySelector(a))};c.$$=function(a,c){return c||(c=b),z.call(c.querySelectorAll(a))};var i;i=a.getComputedStyle?a.getComputedStyle:function(a){return this.el=h(a),this.getPropertyValue=function(b){var c=/(\-([a-z]){1})/g;return"float"==b&&(b="styleFloat"),c.test(b)&&(b=b.replace(c,function(){return arguments[2].toUpperCase()})),a.currentStyle[b]?a.currentStyle[b]:null},this};var j=c.css=function(a,b){return a=h(a),i(h(a)).getPropertyValue(b)},k=c.isVisible=function(a){return a=h(a),a?"BODY"===a.nodeName?!0:"hidden"==j(a,"visibility")?!1:"none"==j(a,"display")?!1:"0"==j(a,"opacity")?!1:k(a.parentNode):!1},l={},m=c.on=function(b,c,d){l[b]="undefined"==typeof l[b]?[]:l[b],l[b].push(function(b){return c.apply(d||a,b)})};c.once=function(a,b,c){m(a,function(){b(),b=B},c)};var n=c.emit=function(a){if("undefined"!=typeof l[a])for(var b=z.call(arguments,1),c=0;c<I(l[a]);c++)l[a][c](b)},o=a.onresize||B;a.onresize=function(){try{o()}catch(a){}n("resize")},e(function(){n("load")});var p,q=a.ActiveXObject;if(q)try{var r=new q("ShockwaveFlash.ShockwaveFlash");if(r){var s=r.GetVariable("$version").substring(4);p=s.replace(",",".")}}catch(t){}else{var u=a.navigator.plugins["Shockwave Flash"];u&&u.description&&(p=u.description.match(/(\d+)\.(\d+)/)[0])}var v=c.flash=p>=6?p:!1,w=function(a,b,c,d){this.params={quality:"best"},this.vars={quality:"best"},this.attrs={swf:a,id:H(),w:c,h:d}};w.prototype={addParam:function(a,b){this.params[a]=b},addVariable:function(a,b){this.vars[a]=b},getVars:function(){var a,b=[];for(a in this.vars)b.push(a+"="+this.vars[a]);return b},getSWFHTML:function(){var a,b=this.params,c=this.attrs,d=this.getVars().join("&"),e=' width="'+c.w+'" height="'+c.h+'" id="'+c.id+'" name="flashfile"';if(q){a='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+e+'><param name="movie" value="'+c.swf+'" />';for(f in b)a+='<param name="'+f+'" value="'+b[f]+'" />';I(d)>0&&(a+='<param name="flashvars" value="'+d+'" />'),a+="</object>"}else{a='<embed type="application/x-shockwave-flash" src="'+c.swf+'"'+e;for(var f in b)a+=f+'="'+b[f]+'" ';a+='flashvars="'+d+'"/>'}return a},write:function(a){if(v){var b=h("#"+a);if(b)return b.innerHTML=this.getSWFHTML(),!0}return!1}},a.baSWFObject=w;var x=c.parseJSON=JSON.parse,y=Object.prototype.toString,z=Array.prototype.slice,A=encodeURIComponent;b.location;var B=function(){},C=function(a){return a&&"function"==typeof a},D=function(a){return a&&"object"==typeof a&&"[object Object]"===y.call(a)},E=function(a){return a&&"object"==typeof a&&"[object Array]"===y.call(a)},F=function(a){return a&&"string"==typeof a},G=function(a){return a?1===a.nodeType:!1},H=c.guid=function(){var a=function(){return(0|65536*(1+Math.random())).toString(16).substring(1)};return"ad_"+a()+"_"+a()+"_"+a()+"_"+a()},I=function(a){return a.length},J=function(a,b){var c,d={};for(c in a)a.hasOwnProperty(c)&&(d[c]=a[c]);for(c in b)b.hasOwnProperty(c)&&(d[c]=b[c]);return d},K=function(b){c.baseUrl=c.baseUrl||"";for(var e={baseUrl:c.baseUrl,xhrTimeout:5e3},f=0;f<I(b);f++){var g=b[f];C(g)?e.ondone=g:D(g)?e=J(e,g):E(g)?e.adspaces=g:F(g)&&(e.baseUrl=g)}if(!E(e.adspaces)){var h=a.ba_adspaces;if(!h||0===I(h)||h.loaded)return d.error("adspaces empty"),!1;h.loaded=!0,e.adspaces=h}var i=e.contexts={},j=e.adspaces;for(f=0;f<I(j);f++){var k=j[f];if(k.id>0){var l=k.context||"_GLOBAL_";k.context=i[l]=i[l]||{name:l,ids:[],adspaces:{},keyword:k.keyword||"",searchword:k.searchword||"",adServingLoad:""},i[l].ids.push(k.id),i[l].adspaces[k.id]=k}else d.error("no id",k)}return e},L=function(a,b){var c=!1;return function(){c||(c=!0,a(),setTimeout(function(){a(),c=!1},b))}},M=function(a){var c,e=a.ctx,g=e.conf;if(d.log("loading adspace "+a.adspace+" into "+a.target),a.campaign&&a.banner&&a.adspace){var h=e.adspaces[a.adspace],i="script_"+h.target+"_"+h.id,j=b.getElementById(i);if(j)d.error("already loaded "+i);else{j=b.createElement("script"),j.id=i,j.type="text/javascript",j.async=!1,j.onload=j.onreadystatechange=function(){return function(){}}(a,e),j.src=g.baseUrl+"/api/v1/get/js_banner"+"?adspaceid="+A(h.id)+"&campaignid="+A(a.campaign)+"&bannerid="+A(a.banner)+"&appendTo="+A(h.target);var k=b.getElementById(h.target);k.innerHTML="",k.parentNode.insertBefore(j,k),c=g.baseUrl+"/api/v2/count/view?adspaceid="+cmp.adspace+"&campaignid="+A(cmp.campaign)+"&bannerid="+A(cmp.banner)+"&keyword="+A(e.keyword)+"&searchword="+A(e.searchword),f(c,function(a,b){d.log(b)})}}else c=g.baseUrl+"/api/v2/count/load?adspaceid="+a.adspace+"&keyword="+A(e.keyword)+"&searchword="+A(e.searchword),f(c,function(a,b){d.log(b)})},N=L(function(){for(var a=[],b=0;b<I(O);b++){var c=O[b];k("#"+c.target)?M(c):a.push(c)}O=a},1e3);c.on("resize",N);var O=[];return c.loadAdspaces=function(){var a=K(arguments);for(var b in a.contexts){var c=a.contexts[b],f=a.baseUrl+"/api/v2/get/campaigns.json?adspaces="+c.ids.join(",")+"&adServingLoad="+A(c.adServingLoad)+"&keyword="+A(c.keyword)+"&searchword="+A(c.searchword);g(f,function(b){return b.conf=a,function(a,c){if(a)d.error(a);else for(var f=c.campaigns,g=0;g<I(f);g++){var h=f[g];h.ctx=b,h.target=b.adspaces[h.adspace].target,O.push(h)}e(function(){var a=setInterval(function(){N(),0==I(O)&&(d.log("No more adspaces to load"),clearInterval(a))},500)})}}(c))}return a},c});